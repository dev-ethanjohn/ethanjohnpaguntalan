---
import { projects } from "../../data/project";

interface Props {
  withoutImage?: boolean;
  projectId?: string;
}

const { withoutImage, projectId } = Astro.props;
---

<div class="projects-grid">
  {
    projects.map(async (project) => (
      <div>
        {withoutImage && projectId === project.id ? (
          <div style="border-radius: 0.5rem;">
            <img
              style="height: auto; width: 100%; border-radius: 0.5rem; opacity: 0;"
              src={project.src}
              alt=""
            />
          </div>
        ) : (
          <div transition:name={`wrapper-${project.id}`} class="project-card">
            <a href={`/home/projects/${project.id}`} class="project">
              <div class="project-card__thumbnail">
                <img
                  class="project-card__image"
                  style="height: 100%; width: 100%; border-radius: 0.5rem;"
                  src={project.src}
                  alt={project.id}
                  transition:name={`image-${project.id}`}
                />
              </div>
            </a>

            <div class="project-card__content">
              <h3 class="project-card__title">{project.title}</h3>
              <p class="project-description">{project.description[0]}</p>

              <div class="project__meta">
                <div class="project__stacks">
                  {project.stack.map((stack) => {
                    return (
                      <small
                        class="tech-stack"
                        style={`background-color: ${stack.color}`}
                      >
                        {stack.name}
                      </small>
                    );
                  })}
                </div>

                <ul class="project__links">
                  <li>
                    <a
                      href="https://example.com/live"
                      target="_blank"
                      class="project__links-live"
                    >
                      live
                    </a>
                  </li>

                  <li>
                    <a
                      href="https://example.com/repo"
                      target="_blank"
                      class="project__links-github"
                    >
                      repo
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        )}
      </div>
    ))
  }
</div>

<style>
  /* GRID */
  .projects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(28rem, 1fr));
    gap: 2rem;
  }

  /* CARD */
  .project-card {
    background-color: white;
    border-radius: 0.5rem;
    overflow: hidden;
  }

  .project-description {
    color: #555555;
    text-decoration: none;
    list-style: none;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.5;
    max-height: calc(1.5em * 3);
  }

  .project-card__thumbnail {
    height: 24rem;
    overflow: hidden;
  }

  .project-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .project-card:hover .project-card__image {
    transform: scale(1.05);
  }

  .project-card__content {
    display: flex;
    flex-direction: column;
    gap: 0.875rem;
    padding: 1.5rem;
  }

  .project-card__title {
    font-size: 1.25rem;
    margin-bottom: 0.5rem;
    color: black;
  }

  /* META */
  .project__meta {
    display: flex;
    justify-content: space-between;
  }
  .project__links {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.375rem;
  }

  .project__stacks {
    display: flex;
    gap: 0.5rem;
  }
  .tech-stack {
    color: rgb(28, 28, 28);
    display: flex;
    align-items: center;
    padding: 0 0.75rem;
    border-radius: 0.3rem;
    font-weight: 500;
    transition:
      transform 0.25s ease,
      box-shadow 0.25s ease,
      background-color 0.25s ease,
      filter 0.25s ease,
      color 0.25s ease;
  }

  .tech-stack:hover {
    transform: scale(1.1);
    filter: brightness(1.15) saturate(3);
    box-shadow:
      rgba(0, 0, 0, 0.15) 0px -23px 25px 0px inset,
      rgba(0, 0, 0, 0.13) 0px -36px 30px 0px inset,
      rgba(0, 0, 0, 0.08) 0px -79px 40px 0px inset,
      rgba(0, 0, 0, 0.04) 0px 2px 1px,
      rgba(0, 0, 0, 0.07) 0px 4px 2px,
      rgba(0, 0, 0, 0.07) 0px 8px 4px,
      rgba(0, 0, 0, 0.07) 0px 16px 8px,
      rgba(0, 0, 0, 0.07) 0px 32px 16px;
    color: #111;
  }

  .project__links a:hover {
    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.32);
  }

  .project__links-live {
    border-radius: 100px 0 0 100px;
  }

  .project__links-live:hover {
    border-radius: 100px 0 0 100px;
  }

  .project__links-github {
    border-radius: 0 100px 100px 0;
  }
</style>
